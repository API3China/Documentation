(window.webpackJsonp=window.webpackJsonp||[]).push([[393],{1036:function(s,e,a){"use strict";a.r(e);var t=a(15),n=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("TitleSpan",[s._v("快速部署容器")]),s._v(" "),a("h1",{attrs:{id:"frontmatter-title"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#frontmatter-title"}},[s._v("#")]),s._v(" "+s._s(s.$frontmatter.title))]),s._v(" "),a("VersionWarning"),s._v(" "),a("TocHeader"),s._v(" "),a("TOC",{staticClass:"table-of-contents",attrs:{"include-level":[2,3]}}),s._v(" "),a("p",[s._v("这个演示是一个简单的Airnode部署，使用实践的方法，以更好地理解Airnode"),a("RouterLink",{attrs:{to:"/airnode/v0.6/grp-providers/docker/deployer-image.html"}},[s._v("客户端镜像")]),s._v("的整体部署过程，它将Airnode的链外组件（"),a("RouterLink",{attrs:{to:"/airnode/v0.6/"}},[s._v("又称节点")]),s._v("）部署到Docker容器中，在这种情况下，作为一个本地运行的Docker容器。 它使用来自"),a("a",{attrs:{href:"https://www.coingecko.com/en/api/documentation",target:"_blank",rel:"noopener noreferrer"}},[s._v("CoinGecko"),a("OutboundLink")],1),s._v("的API端点（"),a("code",[s._v("GET /simple/price")]),s._v("），返回一个代币的当前价值。 这个演示并没有详细说明Airnode的整体配置，它只是一个快速入门。")],1),s._v(" "),a("p",[s._v("Airnode Docker容器部署使用Docker镜像 (称为 "),a("RouterLink",{attrs:{to:"/airnode/v0.6/grp-providers/docker/deployer-image.html"}},[s._v("客户端镜像")]),s._v(")，反过来 需要两个文件作为输入。")],1),s._v(" "),a("ul",[a("li",[a("RouterLink",{attrs:{to:"/airnode/v0.6/grp-providers/tutorial/quick-deploy-container/config-json.html"}},[s._v("config.json")])],1),s._v(" "),a("li",[a("RouterLink",{attrs:{to:"/airnode/v0.6/grp-providers/tutorial/quick-deploy-container/secrets-env.html"}},[s._v("secrets.env")])],1)]),s._v(" "),a("p",[s._v("为了开展演示，这些文件已经创建，只需要你做一些小的改动，就可以成功部署演示的Airnode。 这些修改是为了提供一个链供应商的网址和一个助记符。")]),s._v(" "),a("h2",{attrs:{id:"安装预设"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装预设"}},[s._v("#")]),s._v(" 安装预设")]),s._v(" "),a("p",[s._v("安装 "),a("a",{attrs:{href:"https://docs.docker.com/get-docker/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker桌面"),a("OutboundLink")],1),s._v(" 并启动它。")]),s._v(" "),a("h2",{attrs:{id:"项目文件夹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目文件夹"}},[s._v("#")]),s._v(" 项目文件夹")]),s._v(" "),a("p",[s._v("此演示需要一个项目文件夹。 您可以手动创建它，或下载准备就绪的压缩文件。")]),s._v(" "),a("Tabs",{attrs:{type:"border-card"}},[a("Tab",{attrs:{label:"手动创建"}},[a("p",[s._v("创建一个名为"),a("code",[s._v("quick-deploy-container")]),s._v("的文件夹，内部文件夹名为"),a("code",[s._v("/config")]),s._v("。 将所提供的文件（[config.json、"),a("RouterLink",{attrs:{to:"/airnode/v0.6/grp-providers/tutorial/quick-deploy-container/secrets-env.html"}},[s._v("secrets.env")]),s._v("和aws.env](./config-json.md)）的内容放入以下所示的位置。")],1),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("quick-deploy-container\n├── config\n    ├── config.json\n    └── secrets.env\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("Tab",{attrs:{label:"下载"}},[a("p",[s._v("下载 "),a("a",{attrs:{href:"/zip-files/quick-deploy-container-v0.6.zip",download:""}},[s._v("\nquick-deploy-aws")]),s._v(" 项目文件夹。")])])],1),s._v(" "),a("h2",{attrs:{id:"系统配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#系统配置"}},[s._v("#")]),s._v(" 系统配置")]),s._v(" "),a("p",[s._v("Airnode 运行需要两个配置文件： "),a("code",[s._v("config.json")]),s._v(" 以及 "),a("code",[s._v("secrets.env")]),s._v("。 默认情况下，Airnode客户端镜像会在"),a("code",[s._v("/config")]),s._v("文件夹中寻找它们。")]),s._v(" "),a("h3",{attrs:{id:"config-json"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#config-json"}},[s._v("#")]),s._v(" config.json")]),s._v(" "),a("p",[s._v("这个文件不需要你做任何改动。 它只用一个API端点创建。 它将指示Airnode连接到Rinkeby测试网络。 此文件将从 "),a("code",[s._v("secrets.env")]),s._v(" 中提取两个变量。")]),s._v(" "),a("h3",{attrs:{id:"secrets-env"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#secrets-env"}},[s._v("#")]),s._v(" secrets.env")]),s._v(" "),a("p",[s._v("为每个字段添加值。")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("CHAIN_PROVIDER_URL")]),s._v(":来自链供应商（如"),a("a",{attrs:{href:"https://infura.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Infura"),a("OutboundLink")],1),s._v("）的网址。 请确保你使用的提供者网址是Rinkeby测试网络的。 使用Infura以外的其他连锁供应商也是可以接受的。")]),s._v(" "),a("ul",[a("li",[s._v("注册或登录Infura。")]),s._v(" "),a("li",[s._v("创建一个新的项目，选择项目中的"),a("strong",[s._v("设置")]),s._v("标签。")]),s._v(" "),a("li",[s._v("在端点选择列表下复制Rinkeby的 URL (https)")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("AIRNODE_WALLET_MNEMONIC")]),s._v(": 为数字钱包提供种子短语（助记符）。 在本演示中，它不需要Rinkeby测试网络中的eth。 如果你没有，请使用管理员CLI命令"),a("RouterLink",{attrs:{to:"/airnode/v0.6/reference/packages/admin-cli.html#generate-mnemonic"}},[s._v("generate-mnemonic")]),s._v("来创建一个助记符，或使用其他你喜欢的方法。")],1)])]),s._v(" "),a("h2",{attrs:{id:"部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[s._v("#")]),s._v(" 部署")]),s._v(" "),a("p",[s._v("确保Docker正在运行，然后从"),a("code",[s._v("quick-deploy-aws")]),s._v("文件夹的根部执行部署器镜像。")]),s._v(" "),a("p",[s._v("运行以下命令以在本地部署演示Airnode。 注意，"),a("code",[s._v("api3/airnode-deployer")]),s._v("的版本与config.json文件中的"),a("code",[s._v("nodeVersion")]),s._v("一致。")]),s._v(" "),a("Tabs",{attrs:{type:"border-card"}},[a("Tab",{attrs:{label:"Linux/Mac/WSL2/PowerShell"}},[a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --detach "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --volume "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('/config:/app/config"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  --name quick-deploy-container-airnode "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  api3/airnode-client:0.6.0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("Tab",{attrs:{label:"Windows CMD"}},[a("p",[s._v("对于Windows，使用 CMD (而不是 PowerShell)。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --detach ^\n  --volume "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%cd%/config:/app/config"')]),s._v(" ^\n  --name quick-deploy-container-airnode ^\n  api3/airnode-client:0.6.0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])],1),s._v(" "),a("h2",{attrs:{id:"开始和停止"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开始和停止"}},[s._v("#")]),s._v(" 开始和停止")]),s._v(" "),a("p",[s._v("您可以使用 Docker 桌面应用程序或通过 终端命令来启动和停止 Airnode 。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop quick-deploy-container-airnode\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start quick-deploy-container-airnode\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#日志"}},[s._v("#")]),s._v(" 日志")]),s._v(" "),a("p",[s._v("您可以使用 Docker 桌面应用程序或 终端命令查看Airnode的日志。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs quick-deploy-container-airnode\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs --follow quick-deploy-container-airnode\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"测试-airnode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#测试-airnode"}},[s._v("#")]),s._v(" 测试 Airnode")]),s._v(" "),a("p",[s._v("在成功部署后，可以使用"),a("a",{attrs:{href:"https://github.com/api3dao/airnode/tree/v0.5/packages/airnode-node#testing-api",target:"_blank",rel:"noopener noreferrer"}},[s._v("test-api.js"),a("OutboundLink")],1),s._v("脚本测试Airnode，它允许你在不访问区块链的情况下执行Airnode端点。")]),s._v(" "),a("p",[s._v("::: 警告 test-api.js")]),s._v(" "),a("p",[a("code",[s._v("test-api.js")]),s._v(" nodejs 脚本是一个不支持的功能，用于内部 开发，不应用于任何生产目的。 这里完全用于演示目的。")]),s._v(" "),a("p",[s._v(":::")]),s._v(" "),a("p",[s._v("Nodejs 脚本 "),a("code",[s._v("test-api.js")]),s._v(" 需要两个参数, endpointId 和 参数才能从集成的 API 获得响应。 这些参数从 "),a("code",[s._v("config.json")]),s._v(" 文件获取.")]),s._v(" "),a("ul",[a("li",[s._v("-e, --endpoint-id [string][required]: 参见 config.json "),a("code",[s._v("triggers.rrp[0].endpointId")])]),s._v(" "),a("li",[s._v('-p, --parameters [string] [default: "{}"]: 查看 config.json '),a("code",[s._v("ois.endpoints[0].parameters[0].name")]),s._v(".")])]),s._v(" "),a("p",[s._v("在下面的请求代码中，预先填写参数。 注意JSON响应值是ETH价格乘以"),a("code",[s._v("1e6")]),s._v("，这是由于在"),a("code",[s._v("config.json")]),s._v("中设置"),a("code",[s._v("_times")]),s._v("保留参数为"),a("code",[s._v("1000000")]),s._v("的结果。 此操作 是正确处理浮点数所必需的。")]),s._v(" "),a("h3",{attrs:{id:"请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#请求"}},[s._v("#")]),s._v(" 请求")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# For Windows CMD replace line termination marker \\ with ^")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it quick-deploy-container-airnode "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" src/cli/test-api.js "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -e 0x6db9e3e3d073ad12b66d28dd85bcf49f58577270b1cc2d48a43c7025f5c27af6 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -p "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{"coinIds":"api3", "coinVs_currencies":"usd"}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("或者，您可以使用 Docker 桌面应用程序为 容器提供的 CLI 命令提示来运行测试。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# For Windows CMD replace line termination marker \\ with ^")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" src/cli/test-api.js "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -e 0x6db9e3e3d073ad12b66d28dd85bcf49f58577270b1cc2d48a43c7025f5c27af6 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  -p "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{"coinIds":"api3", "coinVs_currencies":"usd"}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"响应"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#响应"}},[s._v("#")]),s._v(" 响应")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"encodedValue"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0x0000000000000000000000000000000000000000000000000000000000362b30"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"rawValue"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"api3"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"usd"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.55")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"values"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3550000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("airnode-tutorials-TutorialResponse"),s._v(" "),a("h2",{attrs:{id:"移除airnode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#移除airnode"}},[s._v("#")]),s._v(" 移除Airnode")]),s._v(" "),a("p",[s._v("当你完成这个演示时，你可以删除它。 使用 Docker 桌面应用程序或使用以下终端命令。 当使用 终端命令时，如果正在运行，会先停止容器。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果容器正在运行，请停止它。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop quick-deploy-container-airnode\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" quick-deploy-container-airnode\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),a("p",[s._v("您已经在 Docker 容器中部署了一个 Airnote，并使用 "),a("code",[s._v("test-api.js")]),s._v(" Nodejs 脚本测试了它。 请记住不支持脚本在生产环境中使用。")]),s._v(" "),a("p",[s._v("如"),a("code",[s._v("config.json")]),s._v("文件中所述，这个Airnode将自己连接到Rinkeby testnet。 Airnode在部署后，开始与Rinkeby testnet上的AnnodeRrp合约联系，以收集请求者向这个Airnode提出的任何请求。 本教程不涉及在链上发出请求，因为其目的只是为了快速部署一个功能性的Airnode。")])],1)}),[],!1,null,null,null);e.default=n.exports}}]);